<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Joern Query Database Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Joern Query Database Blog Atom Feed"><title data-react-helmet="true">Joern Query Database | Joern Query Database</title><meta data-react-helmet="true" property="og:title" content="Joern Query Database | Joern Query Database"><meta data-react-helmet="true" name="description" content="Joern Query Database"><meta data-react-helmet="true" property="og:description" content="Joern Query Database"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_tag" content="default"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><script data-react-helmet="true">document.addEventListener("DOMContentLoaded",(function(){var n=document.getElementById("base-url-issue-banner-container");if(n){var e=window.location.pathname,t="/"===e.substr(-1)?e:e+"/";n.innerHTML=t}}))</script><link rel="stylesheet" href="/styles.43f4bea6.css">
<link rel="preload" href="/styles.7288b055.js" as="script">
<link rel="preload" href="/runtime~main.122311ab.js" as="script">
<link rel="preload" href="/main.4970da00.js" as="script">
<link rel="preload" href="/common.e559ae0f.js" as="script">
<link rel="preload" href="/8.f7bcd556.js" as="script">
<link rel="preload" href="/c4f5d8e4.526791da.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div class="baseUrlIssueBanner_1-cE" style="border:solid red thick;background-color:#ffe6b3;margin:20px;padding:20px;font-size:20px"><p style="font-weight:bold;font-size:30px">Your Docusaurus site did not load properly.</p><p>A very common reason is a wrong site <a href="https://v2.docusaurus.io/docs/docusaurus.config.js/#baseurl" style="font-weight:bold">baseUrl configuration</a>.</p><p>Current configured baseUrl = <span style="font-weight:bold;color:red">/</span>  (default value)</p><p>We suggest trying baseUrl = <span style="font-weight:bold;color:green" id="base-url-issue-banner-container"></span> </p></div><nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><a class="navbar__brand" href="/"><strong class="navbar__title">Joern Query Database</strong></a></div><div class="navbar__items navbar__items--right"></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><strong class="navbar__title">Joern Query Database</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"></ul></div></div></div></nav><div class="main-wrapper"><main><section class="search-section"><div class="search-wrapper"><div class="filler"></div><div class="search"><div class="search-facets"><div><fieldset class="MuiFormControl-root jss2"><legend class="MuiFormLabel-root"><h3>Language</h3></legend><div class="MuiFormGroup-root"><label class="MuiFormControlLabel-root"><span class="MuiButtonBase-root MuiIconButton-root jss3 MuiCheckbox-root MuiCheckbox-colorSecondary MuiIconButton-colorSecondary" aria-disabled="false"><span class="MuiIconButton-label"><input type="checkbox" class="jss6" name="c" data-indeterminate="false"><svg class="MuiSvgIcon-root" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><path d="M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"></path></svg></span></span><span class="MuiTypography-root MuiFormControlLabel-label MuiTypography-body1">c</span></label><label class="MuiFormControlLabel-root"><span class="MuiButtonBase-root MuiIconButton-root jss3 MuiCheckbox-root MuiCheckbox-colorSecondary MuiIconButton-colorSecondary" aria-disabled="false"><span class="MuiIconButton-label"><input type="checkbox" class="jss6" name="java" data-indeterminate="false"><svg class="MuiSvgIcon-root" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><path d="M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"></path></svg></span></span><span class="MuiTypography-root MuiFormControlLabel-label MuiTypography-body1">java</span></label></div></fieldset><fieldset class="MuiFormControl-root jss2"><legend class="MuiFormLabel-root"><h3>Tags</h3></legend><div class="MuiFormGroup-root"><label class="MuiFormControlLabel-root"><span class="MuiButtonBase-root MuiIconButton-root jss3 MuiCheckbox-root MuiCheckbox-colorSecondary MuiIconButton-colorSecondary" aria-disabled="false"><span class="MuiIconButton-label"><input type="checkbox" class="jss6" name="default" data-indeterminate="false"><svg class="MuiSvgIcon-root" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><path d="M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"></path></svg></span></span><span class="MuiTypography-root MuiFormControlLabel-label MuiTypography-body1">default</span></label><label class="MuiFormControlLabel-root"><span class="MuiButtonBase-root MuiIconButton-root jss3 MuiCheckbox-root MuiCheckbox-colorSecondary MuiIconButton-colorSecondary" aria-disabled="false"><span class="MuiIconButton-label"><input type="checkbox" class="jss6" name="badfn" data-indeterminate="false"><svg class="MuiSvgIcon-root" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><path d="M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"></path></svg></span></span><span class="MuiTypography-root MuiFormControlLabel-label MuiTypography-body1">badfn</span></label><label class="MuiFormControlLabel-root"><span class="MuiButtonBase-root MuiIconButton-root jss3 MuiCheckbox-root MuiCheckbox-colorSecondary MuiIconButton-colorSecondary" aria-disabled="false"><span class="MuiIconButton-label"><input type="checkbox" class="jss6" name="metrics" data-indeterminate="false"><svg class="MuiSvgIcon-root" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><path d="M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"></path></svg></span></span><span class="MuiTypography-root MuiFormControlLabel-label MuiTypography-body1">metrics</span></label><label class="MuiFormControlLabel-root"><span class="MuiButtonBase-root MuiIconButton-root jss3 MuiCheckbox-root MuiCheckbox-colorSecondary MuiIconButton-colorSecondary" aria-disabled="false"><span class="MuiIconButton-label"><input type="checkbox" class="jss6" name="integers" data-indeterminate="false"><svg class="MuiSvgIcon-root" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><path d="M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"></path></svg></span></span><span class="MuiTypography-root MuiFormControlLabel-label MuiTypography-body1">integers</span></label><label class="MuiFormControlLabel-root"><span class="MuiButtonBase-root MuiIconButton-root jss3 MuiCheckbox-root MuiCheckbox-colorSecondary MuiIconButton-colorSecondary" aria-disabled="false"><span class="MuiIconButton-label"><input type="checkbox" class="jss6" name="uaf" data-indeterminate="false"><svg class="MuiSvgIcon-root" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><path d="M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"></path></svg></span></span><span class="MuiTypography-root MuiFormControlLabel-label MuiTypography-body1">uaf</span></label><label class="MuiFormControlLabel-root"><span class="MuiButtonBase-root MuiIconButton-root jss3 MuiCheckbox-root MuiCheckbox-colorSecondary MuiIconButton-colorSecondary" aria-disabled="false"><span class="MuiIconButton-label"><input type="checkbox" class="jss6" name="setxid" data-indeterminate="false"><svg class="MuiSvgIcon-root" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><path d="M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"></path></svg></span></span><span class="MuiTypography-root MuiFormControlLabel-label MuiTypography-body1">setxid</span></label><label class="MuiFormControlLabel-root"><span class="MuiButtonBase-root MuiIconButton-root jss3 MuiCheckbox-root MuiCheckbox-colorSecondary MuiIconButton-colorSecondary" aria-disabled="false"><span class="MuiIconButton-label"><input type="checkbox" class="jss6" name="badimpl" data-indeterminate="false"><svg class="MuiSvgIcon-root" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><path d="M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"></path></svg></span></span><span class="MuiTypography-root MuiFormControlLabel-label MuiTypography-body1">badimpl</span></label><label class="MuiFormControlLabel-root"><span class="MuiButtonBase-root MuiIconButton-root jss3 MuiCheckbox-root MuiCheckbox-colorSecondary MuiIconButton-colorSecondary" aria-disabled="false"><span class="MuiIconButton-label"><input type="checkbox" class="jss6" name="race-condition" data-indeterminate="false"><svg class="MuiSvgIcon-root" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><path d="M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"></path></svg></span></span><span class="MuiTypography-root MuiFormControlLabel-label MuiTypography-body1">race-condition</span></label><label class="MuiFormControlLabel-root"><span class="MuiButtonBase-root MuiIconButton-root jss3 MuiCheckbox-root MuiCheckbox-colorSecondary MuiIconButton-colorSecondary" aria-disabled="false"><span class="MuiIconButton-label"><input type="checkbox" class="jss6" name="sql-injection" data-indeterminate="false"><svg class="MuiSvgIcon-root" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><path d="M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"></path></svg></span></span><span class="MuiTypography-root MuiFormControlLabel-label MuiTypography-body1">sql-injection</span></label><label class="MuiFormControlLabel-root"><span class="MuiButtonBase-root MuiIconButton-root jss3 MuiCheckbox-root MuiCheckbox-colorSecondary MuiIconButton-colorSecondary" aria-disabled="false"><span class="MuiIconButton-label"><input type="checkbox" class="jss6" name="strings" data-indeterminate="false"><svg class="MuiSvgIcon-root" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><path d="M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"></path></svg></span></span><span class="MuiTypography-root MuiFormControlLabel-label MuiTypography-body1">strings</span></label><label class="MuiFormControlLabel-root"><span class="MuiButtonBase-root MuiIconButton-root jss3 MuiCheckbox-root MuiCheckbox-colorSecondary MuiIconButton-colorSecondary" aria-disabled="false"><span class="MuiIconButton-label"><input type="checkbox" class="jss6" name="xss" data-indeterminate="false"><svg class="MuiSvgIcon-root" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><path d="M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"></path></svg></span></span><span class="MuiTypography-root MuiFormControlLabel-label MuiTypography-body1">xss</span></label></div></fieldset></div></div><div class="search-input"><div class="search-field"><div class="MuiFormControl-root MuiTextField-root MuiFormControl-marginNormal MuiFormControl-fullWidth"><label class="MuiFormLabel-root MuiInputLabel-root MuiInputLabel-formControl MuiInputLabel-animated MuiInputLabel-outlined" data-shrink="false" for="standard-basic" id="standard-basic-label">Search for queries...</label><div class="MuiInputBase-root MuiOutlinedInput-root MuiInputBase-fullWidth MuiInputBase-formControl"><input aria-invalid="false" id="standard-basic" class="MuiInputBase-input MuiOutlinedInput-input"><fieldset aria-hidden="true" class="jss7 MuiOutlinedInput-notchedOutline"><legend class="jss9"><span>Search for queries...</span></legend></fieldset></div></div></div><div class="search-results"><div><div class="MuiPaper-root MuiCard-root main-card mdc-elevation--z10 MuiPaper-elevation1 MuiPaper-rounded"><div class="search-result"><div><h2><span class="search-result-name">call-to-exec</span></h2></div><div><h4>Dangerous function &#x27;java.lang.Runtime.exec:java.lang.Process(java.lang.String)&#x27; used</h4><p>
 A call to the function `java.lang.Runtime.exec:java.lang.Process(java.lang.String)` 
 could result in a potential remote code execution.
</p>CPGQL Query:<div class="code"><pre><code class="language-js">({cpg.method(&quot;java.lang.Runtime.exec&quot;).callIn}).l</code></pre></div><textarea class="hidden" id="call-to-exec">({cpg.method(&quot;java.lang.Runtime.exec&quot;).callIn}).l</textarea></div><div><span class="search-result-author">author: @0x4D5A</span></div><div><span class="search-result-tags">tags: badfn,default</span></div><div><button class="MuiButtonBase-root MuiButton-root MuiButton-contained search-result-copy MuiButton-containedPrimary" tabindex="0" type="button"><span class="MuiButton-label">COPY TO CLIPBOARD</span></button></div></div></div><div class="MuiPaper-root MuiCard-root main-card mdc-elevation--z10 MuiPaper-elevation1 MuiPaper-rounded"><div class="search-result"><div><h2><span class="search-result-name">call-to-gets</span></h2></div><div><h4>Dangerous function gets() used</h4><p>
 Avoid `gets` function as it can lead to reads beyond buffer
 boundary and cause
 buffer overflows. Some secure alternatives are `fgets` and `gets_s`.
</p>CPGQL Query:<div class="code"><pre><code class="language-js">({cpg.method(&quot;(?i)gets&quot;).callIn}).l</code></pre></div><textarea class="hidden" id="call-to-gets">({cpg.method(&quot;(?i)gets&quot;).callIn}).l</textarea></div><div><span class="search-result-author">author: @tuxology</span></div><div><span class="search-result-tags">tags: badfn,default</span></div><div><button class="MuiButtonBase-root MuiButton-root MuiButton-contained search-result-copy MuiButton-containedPrimary" tabindex="0" type="button"><span class="MuiButton-label">COPY TO CLIPBOARD</span></button></div></div></div><div class="MuiPaper-root MuiCard-root main-card mdc-elevation--z10 MuiPaper-elevation1 MuiPaper-rounded"><div class="search-result"><div><h2><span class="search-result-name">call-to-getwd</span></h2></div><div><h4>Dangerous function getwd() used</h4><p>
 Avoid the `getwd` function, it does not check buffer lengths.
 Use `getcwd` instead, as it checks the buffer size.
</p>CPGQL Query:<div class="code"><pre><code class="language-js">({cpg.method(&quot;(?i)getwd&quot;).callIn}).l</code></pre></div><textarea class="hidden" id="call-to-getwd">({cpg.method(&quot;(?i)getwd&quot;).callIn}).l</textarea></div><div><span class="search-result-author">author: @ursachec</span></div><div><span class="search-result-tags">tags: badfn,default</span></div><div><button class="MuiButtonBase-root MuiButton-root MuiButton-contained search-result-copy MuiButton-containedPrimary" tabindex="0" type="button"><span class="MuiButton-label">COPY TO CLIPBOARD</span></button></div></div></div><div class="MuiPaper-root MuiCard-root main-card mdc-elevation--z10 MuiPaper-elevation1 MuiPaper-rounded"><div class="search-result"><div><h2><span class="search-result-name">call-to-scanf</span></h2></div><div><h4>Insecure function scanf() used</h4><p>
 Avoid `scanf` function as it can lead to reads beyond buffer
 boundary and cause buffer overflows. A secure alternative is `fgets`.
</p>CPGQL Query:<div class="code"><pre><code class="language-js">({cpg.method(&quot;(?i)scanf&quot;).callIn}).l</code></pre></div><textarea class="hidden" id="call-to-scanf">({cpg.method(&quot;(?i)scanf&quot;).callIn}).l</textarea></div><div><span class="search-result-author">author: @tuxology</span></div><div><span class="search-result-tags">tags: badfn,default</span></div><div><button class="MuiButtonBase-root MuiButton-root MuiButton-contained search-result-copy MuiButton-containedPrimary" tabindex="0" type="button"><span class="MuiButton-label">COPY TO CLIPBOARD</span></button></div></div></div><div class="MuiPaper-root MuiCard-root main-card mdc-elevation--z10 MuiPaper-elevation1 MuiPaper-rounded"><div class="search-result"><div><h2><span class="search-result-name">call-to-strcat</span></h2></div><div><h4>Dangerous functions `strcat` or `strncat` used</h4><p>
 Avoid `strcat` or `strncat` functions. These can be used insecurely
 causing non null-termianted strings leading to memory corruption.
 A secure alternative is `strcat_s`.
</p>CPGQL Query:<div class="code"><pre><code class="language-js">({cpg.method(&quot;(?i)(strcat|strncat)&quot;).callIn}).l</code></pre></div><textarea class="hidden" id="call-to-strcat">({cpg.method(&quot;(?i)(strcat|strncat)&quot;).callIn}).l</textarea></div><div><span class="search-result-author">author: @tuxology</span></div><div><span class="search-result-tags">tags: badfn,default</span></div><div><button class="MuiButtonBase-root MuiButton-root MuiButton-contained search-result-copy MuiButton-containedPrimary" tabindex="0" type="button"><span class="MuiButton-label">COPY TO CLIPBOARD</span></button></div></div></div><div class="MuiPaper-root MuiCard-root main-card mdc-elevation--z10 MuiPaper-elevation1 MuiPaper-rounded"><div class="search-result"><div><h2><span class="search-result-name">call-to-strcpy</span></h2></div><div><h4>Dangerous functions `strcpy` or `strncpy` used</h4><p>
 Avoid `strcpy` or `strncpy` function. `strcpy` does not check buffer
 lengths.
 A possible mitigation could be `strncpy` which could prevent
 buffer overflows but does not null-terminate strings leading to
 memory corruption. A secure alternative (on BSD) is `strlcpy`.
</p>CPGQL Query:<div class="code"><pre><code class="language-js">({cpg.method(&quot;(?i)(strcpy|strncpy)&quot;).callIn}).l</code></pre></div><textarea class="hidden" id="call-to-strcpy">({cpg.method(&quot;(?i)(strcpy|strncpy)&quot;).callIn}).l</textarea></div><div><span class="search-result-author">author: @tuxology</span></div><div><span class="search-result-tags">tags: badfn,default</span></div><div><button class="MuiButtonBase-root MuiButton-root MuiButton-contained search-result-copy MuiButton-containedPrimary" tabindex="0" type="button"><span class="MuiButton-label">COPY TO CLIPBOARD</span></button></div></div></div><div class="MuiPaper-root MuiCard-root main-card mdc-elevation--z10 MuiPaper-elevation1 MuiPaper-rounded"><div class="search-result"><div><h2><span class="search-result-name">call-to-strtok</span></h2></div><div><h4>Dangerous function strtok() used</h4><p>
 Avoid `strtok` function as it modifies the original string in place
 and appends a null character after each token. This makes the
 original string unsafe. Suggested alternative is `strtok_r` with
 `saveptr`.
</p>CPGQL Query:<div class="code"><pre><code class="language-js">({cpg.method(&quot;(?i)strtok&quot;).callIn}).l</code></pre></div><textarea class="hidden" id="call-to-strtok">({cpg.method(&quot;(?i)strtok&quot;).callIn}).l</textarea></div><div><span class="search-result-author">author: @tuxology</span></div><div><span class="search-result-tags">tags: badfn,default</span></div><div><button class="MuiButtonBase-root MuiButton-root MuiButton-contained search-result-copy MuiButton-containedPrimary" tabindex="0" type="button"><span class="MuiButton-label">COPY TO CLIPBOARD</span></button></div></div></div><div class="MuiPaper-root MuiCard-root main-card mdc-elevation--z10 MuiPaper-elevation1 MuiPaper-rounded"><div class="search-result"><div><h2><span class="search-result-name">copy-loop</span></h2></div><div><h4>Copy loop detected</h4><p>
For (buf, indices) pairs, determine those inside control structures (for, while, if ...)
where any of the calls made outside of the body (block) are Inc operations. Determine
the first argument of that Inc operation and check if they are used as indices for
the write operation into the buffer.
</p>CPGQL Query:<div class="code"><pre><code class="language-js">({cpg.assignment.target.isArrayAccess
  .map { access =&gt;
    (access.array, access.subscripts.code.toSet)
  }
  .filter {
    case (buf, subscripts) =&gt;
      val incIdentifiers = buf.inAst.isControlStructure.astChildren
        .filterNot(_.isBlock)
        .assignments
        .target
        .code
        .toSet
      (incIdentifiers &amp; subscripts).nonEmpty
  }
  .map(_._1)}).l</code></pre></div><textarea class="hidden" id="copy-loop">({cpg.assignment.target.isArrayAccess
  .map { access =&gt;
    (access.array, access.subscripts.code.toSet)
  }
  .filter {
    case (buf, subscripts) =&gt;
      val incIdentifiers = buf.inAst.isControlStructure.astChildren
        .filterNot(_.isBlock)
        .assignments
        .target
        .code
        .toSet
      (incIdentifiers &amp; subscripts).nonEmpty
  }
  .map(_._1)}).l</textarea></div><div><span class="search-result-author">author: @fabsx00</span></div><div><span class="search-result-tags">tags: </span></div><div><button class="MuiButtonBase-root MuiButton-root MuiButton-contained search-result-copy MuiButton-containedPrimary" tabindex="0" type="button"><span class="MuiButton-label">COPY TO CLIPBOARD</span></button></div></div></div><div class="MuiPaper-root MuiCard-root main-card mdc-elevation--z10 MuiPaper-elevation1 MuiPaper-rounded"><div class="search-result"><div><h2><span class="search-result-name">file-operation-race</span></h2></div><div><h4>Two file operations on the same path can act on different files</h4><p>
Two subsequent file operations are performed on the same path. Depending on the permissions
on this path, an attacker can exploit a race condition and replace the file or directory
the path refers to between these calls.
Use file operations based on file descriptor/pointer/handles instead of paths to avoid this issue.
</p>CPGQL Query:<div class="code"><pre><code class="language-js">({val firstParam = Set(
  &quot;open&quot;,
  &quot;fopen&quot;,
  &quot;creat&quot;,
  &quot;access&quot;,
  &quot;chmod&quot;,
  &quot;readlink&quot;,
  &quot;chown&quot;,
  &quot;lchown&quot;,
  &quot;stat&quot;,
  &quot;lstat&quot;,
  &quot;unlink&quot;,
  &quot;rmdir&quot;,
  &quot;mkdir&quot;,
  &quot;mknod&quot;,
  &quot;mkfifo&quot;,
  &quot;chdir&quot;,
  &quot;link&quot;,
  &quot;rename&quot;
)
val secondParam = Set(
  &quot;openat&quot;,
  &quot;fstatat&quot;,
  &quot;fchmodat&quot;,
  &quot;readlinkat&quot;,
  &quot;unlinkat&quot;,
  &quot;mkdirat&quot;,
  &quot;mknodat&quot;,
  &quot;mkfifoat&quot;,
  &quot;faccessat&quot;,
  &quot;link&quot;,
  &quot;rename&quot;,
  &quot;linkat&quot;,
  &quot;renameat&quot;
)
val fourthParam = Set(&quot;linkat&quot;, &quot;renameat&quot;)

val anyParam = firstParam ++ secondParam ++ fourthParam

def fileCalls(calls: Traversal[Call]) =
  calls.nameExact(anyParam.toSeq: _*)

def fileArgs(c: Call) = {
  val res = Traversal.newBuilder[Expression]
  // note some functions are in multiple setts because they take multiple paths
  if (firstParam.contains(c.name)) {
    res.addOne(c.argument(1))
  }
  if (secondParam.contains(c.name)) {
    res.addOne(c.argument(2))
  }
  if (fourthParam.contains(c.name)) {
    res.addOne(c.argument(4))
  }
  res.result().whereNot(_.isLiteral)
}

fileCalls(cpg.call)
  .filter(call =&gt; {
    val otherCalls = fileCalls(call.method.ast.isCall).filter(_ != call)
    val argsForOtherCalls =
      otherCalls.flatMap(c =&gt; fileArgs(c)).code.toSet

    fileArgs(call).code.exists(arg =&gt; argsForOtherCalls.contains(arg))
  })}).l</code></pre></div><textarea class="hidden" id="file-operation-race">({val firstParam = Set(
  &quot;open&quot;,
  &quot;fopen&quot;,
  &quot;creat&quot;,
  &quot;access&quot;,
  &quot;chmod&quot;,
  &quot;readlink&quot;,
  &quot;chown&quot;,
  &quot;lchown&quot;,
  &quot;stat&quot;,
  &quot;lstat&quot;,
  &quot;unlink&quot;,
  &quot;rmdir&quot;,
  &quot;mkdir&quot;,
  &quot;mknod&quot;,
  &quot;mkfifo&quot;,
  &quot;chdir&quot;,
  &quot;link&quot;,
  &quot;rename&quot;
)
val secondParam = Set(
  &quot;openat&quot;,
  &quot;fstatat&quot;,
  &quot;fchmodat&quot;,
  &quot;readlinkat&quot;,
  &quot;unlinkat&quot;,
  &quot;mkdirat&quot;,
  &quot;mknodat&quot;,
  &quot;mkfifoat&quot;,
  &quot;faccessat&quot;,
  &quot;link&quot;,
  &quot;rename&quot;,
  &quot;linkat&quot;,
  &quot;renameat&quot;
)
val fourthParam = Set(&quot;linkat&quot;, &quot;renameat&quot;)

val anyParam = firstParam ++ secondParam ++ fourthParam

def fileCalls(calls: Traversal[Call]) =
  calls.nameExact(anyParam.toSeq: _*)

def fileArgs(c: Call) = {
  val res = Traversal.newBuilder[Expression]
  // note some functions are in multiple setts because they take multiple paths
  if (firstParam.contains(c.name)) {
    res.addOne(c.argument(1))
  }
  if (secondParam.contains(c.name)) {
    res.addOne(c.argument(2))
  }
  if (fourthParam.contains(c.name)) {
    res.addOne(c.argument(4))
  }
  res.result().whereNot(_.isLiteral)
}

fileCalls(cpg.call)
  .filter(call =&gt; {
    val otherCalls = fileCalls(call.method.ast.isCall).filter(_ != call)
    val argsForOtherCalls =
      otherCalls.flatMap(c =&gt; fileArgs(c)).code.toSet

    fileArgs(call).code.exists(arg =&gt; argsForOtherCalls.contains(arg))
  })}).l</textarea></div><div><span class="search-result-author">author: @maltek</span></div><div><span class="search-result-tags">tags: race-condition,default</span></div><div><button class="MuiButtonBase-root MuiButton-root MuiButton-contained search-result-copy MuiButton-containedPrimary" tabindex="0" type="button"><span class="MuiButton-label">COPY TO CLIPBOARD</span></button></div></div></div><div class="MuiPaper-root MuiCard-root main-card mdc-elevation--z10 MuiPaper-elevation1 MuiPaper-rounded"><div class="search-result"><div><h2><span class="search-result-name">format-controlled-printf</span></h2></div><div><h4>Non-constant format string passed to printf/sprintf/vsprintf</h4><p>
 Avoid user controlled format strings like &quot;argv&quot; in printf, sprintf and vsprintf 
 functions as they can cause memory corruption. Some secure
 alternatives are `snprintf` and `vsnprintf`.
</p>CPGQL Query:<div class="code"><pre><code class="language-js">({val printfFns = cpg
  .method(&quot;(?i)printf&quot;)
  .callIn
  .whereNot(_.argument.order(1).isLiteral)
val sprintsFns = cpg
  .method(&quot;(?i)(sprintf|vsprintf)&quot;)
  .callIn
  .whereNot(_.argument.order(2).isLiteral)
(printfFns ++ sprintsFns)}).l</code></pre></div><textarea class="hidden" id="format-controlled-printf">({val printfFns = cpg
  .method(&quot;(?i)printf&quot;)
  .callIn
  .whereNot(_.argument.order(1).isLiteral)
val sprintsFns = cpg
  .method(&quot;(?i)(sprintf|vsprintf)&quot;)
  .callIn
  .whereNot(_.argument.order(2).isLiteral)
(printfFns ++ sprintsFns)}).l</textarea></div><div><span class="search-result-author">author: @tuxology</span></div><div><span class="search-result-tags">tags: badfn,default</span></div><div><button class="MuiButtonBase-root MuiButton-root MuiButton-contained search-result-copy MuiButton-containedPrimary" tabindex="0" type="button"><span class="MuiButton-label">COPY TO CLIPBOARD</span></button></div></div></div><div class="MuiPaper-root MuiCard-root main-card mdc-elevation--z10 MuiPaper-elevation1 MuiPaper-rounded"><div class="search-result"><div><h2><span class="search-result-name">free-field-no-reassign</span></h2></div><div><h4>A field of a parameter is free&#x27;d and not reassigned on all paths</h4><p>
 The function is able to modify a field of a structure passed in by
 the caller. It frees this field and does not guarantee that on
 all paths to the exit, the field is reassigned. If any
 caller now accesses the field, then it accesses memory that is no
 longer allocated. We also check that the function does not free
 or clear the entire structure, as in that case, it is unlikely that the
 passed in structure will be used again.
</p>CPGQL Query:<div class="code"><pre><code class="language-js">({val freeOfStructField = cpg
  .method(&quot;free&quot;)
  .callIn
  .where(
    _.argument(1)
      .isCallTo(&quot;&lt;operator&gt;.*[fF]ieldAccess.*&quot;)
      .filter(x =&gt;
        x.method.parameter.name.toSet.contains(x.argument(1).code))
  )
  .whereNot(_.argument(1).isCall.argument(1).filter { struct =&gt;
    struct.method.ast.isCall
      .name(&quot;.*free$&quot;, &quot;memset&quot;, &quot;bzero&quot;)
      .argument(1)
      .codeExact(struct.code)
      .nonEmpty
  })
  .l

freeOfStructField.argument(1).filter { arg =&gt;
  arg.method.methodReturn.reachableBy(arg).nonEmpty
}}).l</code></pre></div><textarea class="hidden" id="free-field-no-reassign">({val freeOfStructField = cpg
  .method(&quot;free&quot;)
  .callIn
  .where(
    _.argument(1)
      .isCallTo(&quot;&lt;operator&gt;.*[fF]ieldAccess.*&quot;)
      .filter(x =&gt;
        x.method.parameter.name.toSet.contains(x.argument(1).code))
  )
  .whereNot(_.argument(1).isCall.argument(1).filter { struct =&gt;
    struct.method.ast.isCall
      .name(&quot;.*free$&quot;, &quot;memset&quot;, &quot;bzero&quot;)
      .argument(1)
      .codeExact(struct.code)
      .nonEmpty
  })
  .l

freeOfStructField.argument(1).filter { arg =&gt;
  arg.method.methodReturn.reachableBy(arg).nonEmpty
}}).l</textarea></div><div><span class="search-result-author">author: @fabsx00</span></div><div><span class="search-result-tags">tags: uaf,default</span></div><div><button class="MuiButtonBase-root MuiButton-root MuiButton-contained search-result-copy MuiButton-containedPrimary" tabindex="0" type="button"><span class="MuiButton-label">COPY TO CLIPBOARD</span></button></div></div></div><div class="MuiPaper-root MuiCard-root main-card mdc-elevation--z10 MuiPaper-elevation1 MuiPaper-rounded"><div class="search-result"><div><h2><span class="search-result-name">free-follows-value-reuse</span></h2></div><div><h4>A value that is free&#x27;d is reused without reassignment.</h4><p>
A value is used after being free&#x27;d in a path that leads to it
without reassignment.

Modeled after CVE-2019-18903.
</p>CPGQL Query:<div class="code"><pre><code class="language-js">({cpg.method
  .name(&quot;(.*_)?free&quot;)
  .filter(_.parameter.size == 1)
  .callIn
  .where(_.argument(1).isIdentifier)
  .flatMap(f =&gt; {
    val freedIdentifierCode = f.argument(1).code
    val postDom = f.postDominatedBy.toSet

    val assignedPostDom = postDom.isIdentifier
      .where(_.inAssignment)
      .codeExact(freedIdentifierCode)
      .flatMap(id =&gt; id ++ id.postDominatedBy)

    postDom
      .removedAll(assignedPostDom)
      .isIdentifier
      .codeExact(freedIdentifierCode)
  })}).l</code></pre></div><textarea class="hidden" id="free-follows-value-reuse">({cpg.method
  .name(&quot;(.*_)?free&quot;)
  .filter(_.parameter.size == 1)
  .callIn
  .where(_.argument(1).isIdentifier)
  .flatMap(f =&gt; {
    val freedIdentifierCode = f.argument(1).code
    val postDom = f.postDominatedBy.toSet

    val assignedPostDom = postDom.isIdentifier
      .where(_.inAssignment)
      .codeExact(freedIdentifierCode)
      .flatMap(id =&gt; id ++ id.postDominatedBy)

    postDom
      .removedAll(assignedPostDom)
      .isIdentifier
      .codeExact(freedIdentifierCode)
  })}).l</textarea></div><div><span class="search-result-author">author: @maltek</span></div><div><span class="search-result-tags">tags: uaf</span></div><div><button class="MuiButtonBase-root MuiButton-root MuiButton-contained search-result-copy MuiButton-containedPrimary" tabindex="0" type="button"><span class="MuiButton-label">COPY TO CLIPBOARD</span></button></div></div></div><div class="MuiPaper-root MuiCard-root main-card mdc-elevation--z10 MuiPaper-elevation1 MuiPaper-rounded"><div class="search-result"><div><h2><span class="search-result-name">free-returned-value</span></h2></div><div><h4>A value that is returned through a parameter is free&#x27;d in a path</h4><p>
The function sets a field of a function parameter to a value of a local
variable.
This variable is then freed in some paths. Unless the value set in the
function |parameter is overridden later on, the caller has access to the
free&#x27;d memory, which is undefined behavior.

Finds bugs like CVE-2019-18902.
</p>CPGQL Query:<div class="code"><pre><code class="language-js">({def outParams =
  cpg.parameter
    .typeFullName(&quot;.+\\*&quot;)
    .whereNot(
      _.referencingIdentifiers
        .argumentIndex(1)
        .inCall
        .nameExact(Operators.assignment, Operators.addressOf))

def assignedValues =
  outParams.referencingIdentifiers
    .argumentIndex(1)
    .inCall
    .nameExact(Operators.indirectFieldAccess,
               Operators.indirection,
               Operators.indirectIndexAccess)
    .argumentIndex(1)
    .inCall
    .nameExact(Operators.assignment)
    .argument(2)
    .isIdentifier

def freeAssigned =
  assignedValues.map(
    id =&gt;
      (id,
       id.refsTo
         .flatMap {
           case p: MethodParameterIn =&gt; p.referencingIdentifiers
           case v: Local             =&gt; v.referencingIdentifiers
         }
         .inCall
         .name(&quot;(.*_)?free&quot;)))

freeAssigned
  .filter {
    case (id, freeCall) =&gt; freeCall.dominatedBy.exists(_ == id)
  }
  .flatMap(_._1)}).l</code></pre></div><textarea class="hidden" id="free-returned-value">({def outParams =
  cpg.parameter
    .typeFullName(&quot;.+\\*&quot;)
    .whereNot(
      _.referencingIdentifiers
        .argumentIndex(1)
        .inCall
        .nameExact(Operators.assignment, Operators.addressOf))

def assignedValues =
  outParams.referencingIdentifiers
    .argumentIndex(1)
    .inCall
    .nameExact(Operators.indirectFieldAccess,
               Operators.indirection,
               Operators.indirectIndexAccess)
    .argumentIndex(1)
    .inCall
    .nameExact(Operators.assignment)
    .argument(2)
    .isIdentifier

def freeAssigned =
  assignedValues.map(
    id =&gt;
      (id,
       id.refsTo
         .flatMap {
           case p: MethodParameterIn =&gt; p.referencingIdentifiers
           case v: Local             =&gt; v.referencingIdentifiers
         }
         .inCall
         .name(&quot;(.*_)?free&quot;)))

freeAssigned
  .filter {
    case (id, freeCall) =&gt; freeCall.dominatedBy.exists(_ == id)
  }
  .flatMap(_._1)}).l</textarea></div><div><span class="search-result-author">author: @maltek</span></div><div><span class="search-result-tags">tags: uaf</span></div><div><button class="MuiButtonBase-root MuiButton-root MuiButton-contained search-result-copy MuiButton-containedPrimary" tabindex="0" type="button"><span class="MuiButton-label">COPY TO CLIPBOARD</span></button></div></div></div><div class="MuiPaper-root MuiCard-root main-card mdc-elevation--z10 MuiPaper-elevation1 MuiPaper-rounded"><div class="search-result"><div><h2><span class="search-result-name">ineffective-certificate-check</span></h2></div><div><h4>Ineffective Certificate Validation: The validation result is always positive</h4><p>
A certificate validation function is implemented as a function that only consists of a prologue where local
variables are initialized to arguments, followed by a (positive) return statement.
</p>CPGQL Query:<div class="code"><pre><code class="language-js">({val validators = Map(
  // javax.net.ssl.HostnameVerifier
  &quot;verify&quot; -&gt; &quot;boolean(java.lang.String,javax.net.ssl.SSLSession)&quot;,
  // javax.net.ssl.X509ExtendedTrustManager
  &quot;checkClientTrusted&quot; -&gt; &quot;void(java.security.cert.X509Certificate[],java.lang.String,java.net.Socket)&quot;,
  &quot;checkClientTrusted&quot; -&gt; &quot;void(java.security.cert.X509Certificate[],java.lang.String,javax.net.ssl.SSLEngine)&quot;,
  &quot;checkServerTrusted&quot; -&gt; &quot;void(java.security.cert.X509Certificate[],java.lang.String,java.net.Socket)&quot;,
  &quot;checkServerTrusted&quot; -&gt; &quot;void(java.security.cert.X509Certificate[],java.lang.String,javax.net.ssl.SSLEngine)&quot;,
)

// skip over arguments getting copied to local variables
def isPrologue(node: nodes.CfgNode): Boolean = node match {
  case id: nodes.Identifier =&gt;
    id.refsTo.forall(_.isInstanceOf[nodes.Local])
  case c: nodes.Call =&gt;
    c.methodFullName == Operators.assignment &amp;&amp; c.argument.forall(
      isPrologue
    )
  case _ =&gt; false
}
def skipPrologue(node: nodes.CfgNode): Traversal[nodes.CfgNode] =
  node.repeat(_.cfgNext)(_.until(_.filter(!isPrologue(_))))

cpg.method
  .nameExact(validators.keys.toSeq: _*)
  .signatureExact(validators.values.toSeq: _*)
  .cfgFirst
  .flatMap(skipPrologue)
  .filter {
    case lit: nodes.Literal =&gt;
      lit.code == &quot;1&quot; &amp;&amp; lit.cfgNext
        .forall(_.isInstanceOf[nodes.Return])
    case _: nodes.Return =&gt; true
    case _               =&gt; false
  }}).l</code></pre></div><textarea class="hidden" id="ineffective-certificate-check">({val validators = Map(
  // javax.net.ssl.HostnameVerifier
  &quot;verify&quot; -&gt; &quot;boolean(java.lang.String,javax.net.ssl.SSLSession)&quot;,
  // javax.net.ssl.X509ExtendedTrustManager
  &quot;checkClientTrusted&quot; -&gt; &quot;void(java.security.cert.X509Certificate[],java.lang.String,java.net.Socket)&quot;,
  &quot;checkClientTrusted&quot; -&gt; &quot;void(java.security.cert.X509Certificate[],java.lang.String,javax.net.ssl.SSLEngine)&quot;,
  &quot;checkServerTrusted&quot; -&gt; &quot;void(java.security.cert.X509Certificate[],java.lang.String,java.net.Socket)&quot;,
  &quot;checkServerTrusted&quot; -&gt; &quot;void(java.security.cert.X509Certificate[],java.lang.String,javax.net.ssl.SSLEngine)&quot;,
)

// skip over arguments getting copied to local variables
def isPrologue(node: nodes.CfgNode): Boolean = node match {
  case id: nodes.Identifier =&gt;
    id.refsTo.forall(_.isInstanceOf[nodes.Local])
  case c: nodes.Call =&gt;
    c.methodFullName == Operators.assignment &amp;&amp; c.argument.forall(
      isPrologue
    )
  case _ =&gt; false
}
def skipPrologue(node: nodes.CfgNode): Traversal[nodes.CfgNode] =
  node.repeat(_.cfgNext)(_.until(_.filter(!isPrologue(_))))

cpg.method
  .nameExact(validators.keys.toSeq: _*)
  .signatureExact(validators.values.toSeq: _*)
  .cfgFirst
  .flatMap(skipPrologue)
  .filter {
    case lit: nodes.Literal =&gt;
      lit.code == &quot;1&quot; &amp;&amp; lit.cfgNext
        .forall(_.isInstanceOf[nodes.Return])
    case _: nodes.Return =&gt; true
    case _               =&gt; false
  }}).l</textarea></div><div><span class="search-result-author">author: @maltek</span></div><div><span class="search-result-tags">tags: badimpl,default</span></div><div><button class="MuiButtonBase-root MuiButton-root MuiButton-contained search-result-copy MuiButton-containedPrimary" tabindex="0" type="button"><span class="MuiButton-label">COPY TO CLIPBOARD</span></button></div></div></div><div class="MuiPaper-root MuiCard-root main-card mdc-elevation--z10 MuiPaper-elevation1 MuiPaper-rounded"><div class="search-result"><div><h2><span class="search-result-name">malloc-memcpy-int-overflow</span></h2></div><div><h4>Dangerous copy-operation into heap-allocated buffer</h4><p>-</p>CPGQL Query:<div class="code"><pre><code class="language-js">({val src =
  cpg.method(&quot;.*malloc$&quot;).callIn.where(_.argument(1).arithmetics).l

cpg.method(&quot;(?i)memcpy&quot;).callIn.l.filter { memcpyCall =&gt;
  memcpyCall
    .argument(1)
    .reachableBy(src)
    .where(_.inAssignment.target.codeExact(memcpyCall.argument(1).code))
    .whereNot(_.argument(1).codeExact(memcpyCall.argument(3).code))
    .hasNext
}}).l</code></pre></div><textarea class="hidden" id="malloc-memcpy-int-overflow">({val src =
  cpg.method(&quot;.*malloc$&quot;).callIn.where(_.argument(1).arithmetics).l

cpg.method(&quot;(?i)memcpy&quot;).callIn.l.filter { memcpyCall =&gt;
  memcpyCall
    .argument(1)
    .reachableBy(src)
    .where(_.inAssignment.target.codeExact(memcpyCall.argument(1).code))
    .whereNot(_.argument(1).codeExact(memcpyCall.argument(3).code))
    .hasNext
}}).l</textarea></div><div><span class="search-result-author">author: @fabsx00</span></div><div><span class="search-result-tags">tags: integers,default</span></div><div><button class="MuiButtonBase-root MuiButton-root MuiButton-contained search-result-copy MuiButton-containedPrimary" tabindex="0" type="button"><span class="MuiButton-label">COPY TO CLIPBOARD</span></button></div></div></div><div class="MuiPaper-root MuiCard-root main-card mdc-elevation--z10 MuiPaper-elevation1 MuiPaper-rounded"><div class="search-result"><div><h2><span class="search-result-name">multiple-returns</span></h2></div><div><h4>Multiple returns</h4><p>This query identifies functions with more than one return</p>CPGQL Query:<div class="code"><pre><code class="language-js">({cpg.method.internal.filter(_.ast.isReturn.l.size &gt; 1)}).l</code></pre></div><textarea class="hidden" id="multiple-returns">({cpg.method.internal.filter(_.ast.isReturn.l.size &gt; 1)}).l</textarea></div><div><span class="search-result-author">author: @fabsx00</span></div><div><span class="search-result-tags">tags: metrics</span></div><div><button class="MuiButtonBase-root MuiButton-root MuiButton-contained search-result-copy MuiButton-containedPrimary" tabindex="0" type="button"><span class="MuiButton-label">COPY TO CLIPBOARD</span></button></div></div></div><div class="MuiPaper-root MuiCard-root main-card mdc-elevation--z10 MuiPaper-elevation1 MuiPaper-rounded"><div class="search-result"><div><h2><span class="search-result-name">setgid-without-setgroups</span></h2></div><div><h4>Process group membership is changed without setting ancillary groups first</h4><p>
The set*gid system calls do not affect the ancillary groups a process belongs to.
Changes to the group membership should therefore always be preceded by a call to setgroups.
Otherwise the process may still be a secondary member of the group it tries to disavow.
</p>CPGQL Query:<div class="code"><pre><code class="language-js">({cpg
  .method(&quot;(?i)set(res|re|e|)gid&quot;)
  .callIn
  .whereNot(_.dominatedBy.isCall.name(&quot;setgroups&quot;))}).l</code></pre></div><textarea class="hidden" id="setgid-without-setgroups">({cpg
  .method(&quot;(?i)set(res|re|e|)gid&quot;)
  .callIn
  .whereNot(_.dominatedBy.isCall.name(&quot;setgroups&quot;))}).l</textarea></div><div><span class="search-result-author">author: @maltek</span></div><div><span class="search-result-tags">tags: setxid,default</span></div><div><button class="MuiButtonBase-root MuiButton-root MuiButton-contained search-result-copy MuiButton-containedPrimary" tabindex="0" type="button"><span class="MuiButton-label">COPY TO CLIPBOARD</span></button></div></div></div><div class="MuiPaper-root MuiCard-root main-card mdc-elevation--z10 MuiPaper-elevation1 MuiPaper-rounded"><div class="search-result"><div><h2><span class="search-result-name">setuid-without-setgid</span></h2></div><div><h4>Process user ID is changed without changing groups first</h4><p>
The set*uid system calls do not affect the groups a process belongs to. However, often
there exists a group that is equivalent to a user (e.g. wheel or shadow groups are often
equivalent to the root user).
Group membership can only be changed by the root user.
Changes to the user should therefore always be preceded by calls to set*gid and setgroups,
</p>CPGQL Query:<div class="code"><pre><code class="language-js">({cpg
  .method(&quot;(?i)set(res|re|e|)uid&quot;)
  .callIn
  .whereNot(_.dominatedBy.isCall.name(&quot;set(res|re|e|)?gid&quot;))}).l</code></pre></div><textarea class="hidden" id="setuid-without-setgid">({cpg
  .method(&quot;(?i)set(res|re|e|)uid&quot;)
  .callIn
  .whereNot(_.dominatedBy.isCall.name(&quot;set(res|re|e|)?gid&quot;))}).l</textarea></div><div><span class="search-result-author">author: @maltek</span></div><div><span class="search-result-tags">tags: setxid,default</span></div><div><button class="MuiButtonBase-root MuiButton-root MuiButton-contained search-result-copy MuiButton-containedPrimary" tabindex="0" type="button"><span class="MuiButton-label">COPY TO CLIPBOARD</span></button></div></div></div><div class="MuiPaper-root MuiCard-root main-card mdc-elevation--z10 MuiPaper-elevation1 MuiPaper-rounded"><div class="search-result"><div><h2><span class="search-result-name">signed-left-shift</span></h2></div><div><h4>Signed Shift May Cause Undefined Behavior</h4><p>
Signed integer overflow is undefined behavior. Shifts of signed values to the
left are very prone to overflow.
</p>CPGQL Query:<div class="code"><pre><code class="language-js">({cpg.call
  .nameExact(Operators.shiftLeft, Operators.assignmentShiftLeft)
  .where(_.argument(1).typ.fullNameExact(&quot;int&quot;, &quot;long&quot;))
  .filterNot(_.argument.isLiteral.size == 2)}).l</code></pre></div><textarea class="hidden" id="signed-left-shift">({cpg.call
  .nameExact(Operators.shiftLeft, Operators.assignmentShiftLeft)
  .where(_.argument(1).typ.fullNameExact(&quot;int&quot;, &quot;long&quot;))
  .filterNot(_.argument.isLiteral.size == 2)}).l</textarea></div><div><span class="search-result-author">author: @maltek</span></div><div><span class="search-result-tags">tags: integers,default</span></div><div><button class="MuiButtonBase-root MuiButton-root MuiButton-contained search-result-copy MuiButton-containedPrimary" tabindex="0" type="button"><span class="MuiButton-label">COPY TO CLIPBOARD</span></button></div></div></div><div class="MuiPaper-root MuiCard-root main-card mdc-elevation--z10 MuiPaper-elevation1 MuiPaper-rounded"><div class="search-result"><div><h2><span class="search-result-name">sql-injection</span></h2></div><div><h4>SQL injection: A parameter is used in an insecure database API call.</h4><p>
An attacker controlled parameter is used in an insecure database API call.

If the parameter is not validated and sanitized, this is a SQL injection.
</p>CPGQL Query:<div class="code"><pre><code class="language-js">({def source =
  cpg.method
    .where(_.methodReturn.evalType(
      &quot;org.springframework.web.servlet.ModelAndView&quot;))
    .parameter

def sink = cpg.method.name(&quot;query&quot;).parameter.order(1)

sink.reachableBy(source).l}).l</code></pre></div><textarea class="hidden" id="sql-injection">({def source =
  cpg.method
    .where(_.methodReturn.evalType(
      &quot;org.springframework.web.servlet.ModelAndView&quot;))
    .parameter

def sink = cpg.method.name(&quot;query&quot;).parameter.order(1)

sink.reachableBy(source).l}).l</textarea></div><div><span class="search-result-author">author: @0x4D5A</span></div><div><span class="search-result-tags">tags: sql-injection,default</span></div><div><button class="MuiButtonBase-root MuiButton-root MuiButton-contained search-result-copy MuiButton-containedPrimary" tabindex="0" type="button"><span class="MuiButton-label">COPY TO CLIPBOARD</span></button></div></div></div><div class="MuiPaper-root MuiCard-root main-card mdc-elevation--z10 MuiPaper-elevation1 MuiPaper-rounded"><div class="search-result"><div><h2><span class="search-result-name">strlen-truncation</span></h2></div><div><h4>Truncation in assignment involving `strlen` call</h4><p>
The return value of `strlen` is stored in a variable that is known
to be of type `int` as opposed to `size_t`. `int` is only 32 bit
wide on many 64 bit platforms, and thus, this may result in a
truncation.
</p>CPGQL Query:<div class="code"><pre><code class="language-js">({cpg.method
  .name(&quot;(?i)strlen&quot;)
  .callIn
  .inAssignment
  .target
  .evalType(&quot;(g?)int&quot;)}).l</code></pre></div><textarea class="hidden" id="strlen-truncation">({cpg.method
  .name(&quot;(?i)strlen&quot;)
  .callIn
  .inAssignment
  .target
  .evalType(&quot;(g?)int&quot;)}).l</textarea></div><div><span class="search-result-author">author: @fabsx00</span></div><div><span class="search-result-tags">tags: integers,default</span></div><div><button class="MuiButtonBase-root MuiButton-root MuiButton-contained search-result-copy MuiButton-containedPrimary" tabindex="0" type="button"><span class="MuiButton-label">COPY TO CLIPBOARD</span></button></div></div></div><div class="MuiPaper-root MuiCard-root main-card mdc-elevation--z10 MuiPaper-elevation1 MuiPaper-rounded"><div class="search-result"><div><h2><span class="search-result-name">strncpy-no-null-term</span></h2></div><div><h4>strncpy is used and no null termination is nearby</h4><p>
 Upon calling `strncpy` with a source string that is larger
 than the destination buffer, the destination buffer is not
 null-terminated by `strncpy` and there is no explicit
 null termination nearby. This is unproblematic if the
 buffer size is at least 1 larger than the size passed
 to `strncpy`.
</p>CPGQL Query:<div class="code"><pre><code class="language-js">({val allocations = cpg.method(&quot;.*malloc$&quot;).callIn.argument(1).l
cpg
  .method(&quot;(?i)strncpy&quot;)
  .callIn
  .map { c =&gt;
    (c.method, c.argument(1), c.argument(3))
  }
  .filter {
    case (method, dst, size) =&gt;
      dst.reachableBy(allocations).codeExact(size.code).nonEmpty &amp;&amp;
        method.assignments
          .where(_.target.isArrayAccess.code(s&quot;${dst.code}.*\\[.*&quot;))
          .source
          .isLiteral
          .code(&quot;.*0.*&quot;)
          .isEmpty
  }
  .map(_._2)}).l</code></pre></div><textarea class="hidden" id="strncpy-no-null-term">({val allocations = cpg.method(&quot;.*malloc$&quot;).callIn.argument(1).l
cpg
  .method(&quot;(?i)strncpy&quot;)
  .callIn
  .map { c =&gt;
    (c.method, c.argument(1), c.argument(3))
  }
  .filter {
    case (method, dst, size) =&gt;
      dst.reachableBy(allocations).codeExact(size.code).nonEmpty &amp;&amp;
        method.assignments
          .where(_.target.isArrayAccess.code(s&quot;${dst.code}.*\\[.*&quot;))
          .source
          .isLiteral
          .code(&quot;.*0.*&quot;)
          .isEmpty
  }
  .map(_._2)}).l</textarea></div><div><span class="search-result-author">author: @fabsx00</span></div><div><span class="search-result-tags">tags: strings,default</span></div><div><button class="MuiButtonBase-root MuiButton-root MuiButton-contained search-result-copy MuiButton-containedPrimary" tabindex="0" type="button"><span class="MuiButton-label">COPY TO CLIPBOARD</span></button></div></div></div><div class="MuiPaper-root MuiCard-root main-card mdc-elevation--z10 MuiPaper-elevation1 MuiPaper-rounded"><div class="search-result"><div><h2><span class="search-result-name">too-high-complexity</span></h2></div><div><h4>Cyclomatic complexity higher than 4</h4><p>This query identifies functions with a cyclomatic complexity higher than 4</p>CPGQL Query:<div class="code"><pre><code class="language-js">({cpg.method.internal.filter(_.controlStructure.size &gt; n)}).l</code></pre></div><textarea class="hidden" id="too-high-complexity">({cpg.method.internal.filter(_.controlStructure.size &gt; n)}).l</textarea></div><div><span class="search-result-author">author: @fabsx00</span></div><div><span class="search-result-tags">tags: metrics</span></div><div><button class="MuiButtonBase-root MuiButton-root MuiButton-contained search-result-copy MuiButton-containedPrimary" tabindex="0" type="button"><span class="MuiButton-label">COPY TO CLIPBOARD</span></button></div></div></div><div class="MuiPaper-root MuiCard-root main-card mdc-elevation--z10 MuiPaper-elevation1 MuiPaper-rounded"><div class="search-result"><div><h2><span class="search-result-name">too-long</span></h2></div><div><h4>More than 1000 lines</h4><p>This query identifies functions that are more than 1000 lines long</p>CPGQL Query:<div class="code"><pre><code class="language-js">({cpg.method.internal.filter(_.numberOfLines &gt; n)}).l</code></pre></div><textarea class="hidden" id="too-long">({cpg.method.internal.filter(_.numberOfLines &gt; n)}).l</textarea></div><div><span class="search-result-author">author: @fabsx00</span></div><div><span class="search-result-tags">tags: metrics</span></div><div><button class="MuiButtonBase-root MuiButton-root MuiButton-contained search-result-copy MuiButton-containedPrimary" tabindex="0" type="button"><span class="MuiButton-label">COPY TO CLIPBOARD</span></button></div></div></div><div class="MuiPaper-root MuiCard-root main-card mdc-elevation--z10 MuiPaper-elevation1 MuiPaper-rounded"><div class="search-result"><div><h2><span class="search-result-name">too-many-loops</span></h2></div><div><h4>More than 4 loops</h4><p>This query identifies functions with more than 4 loops</p>CPGQL Query:<div class="code"><pre><code class="language-js">({cpg.method.internal
  .filter(
    _.ast.isControlStructure
      .parserTypeName(&quot;(For|Do|While).*&quot;)
      .size &gt; n)}).l</code></pre></div><textarea class="hidden" id="too-many-loops">({cpg.method.internal
  .filter(
    _.ast.isControlStructure
      .parserTypeName(&quot;(For|Do|While).*&quot;)
      .size &gt; n)}).l</textarea></div><div><span class="search-result-author">author: @fabsx00</span></div><div><span class="search-result-tags">tags: metrics</span></div><div><button class="MuiButtonBase-root MuiButton-root MuiButton-contained search-result-copy MuiButton-containedPrimary" tabindex="0" type="button"><span class="MuiButton-label">COPY TO CLIPBOARD</span></button></div></div></div><div class="MuiPaper-root MuiCard-root main-card mdc-elevation--z10 MuiPaper-elevation1 MuiPaper-rounded"><div class="search-result"><div><h2><span class="search-result-name">too-many-params</span></h2></div><div><h4>Number of parameters larger than 4</h4><p>This query identifies functions with more than 4 formal parameters</p>CPGQL Query:<div class="code"><pre><code class="language-js">({cpg.method.internal.filter(_.parameter.size &gt; n)}).l</code></pre></div><textarea class="hidden" id="too-many-params">({cpg.method.internal.filter(_.parameter.size &gt; n)}).l</textarea></div><div><span class="search-result-author">author: @fabsx00</span></div><div><span class="search-result-tags">tags: metrics</span></div><div><button class="MuiButtonBase-root MuiButton-root MuiButton-contained search-result-copy MuiButton-containedPrimary" tabindex="0" type="button"><span class="MuiButton-label">COPY TO CLIPBOARD</span></button></div></div></div><div class="MuiPaper-root MuiCard-root main-card mdc-elevation--z10 MuiPaper-elevation1 MuiPaper-rounded"><div class="search-result"><div><h2><span class="search-result-name">too-nested</span></h2></div><div><h4>Nesting level higher than 3</h4><p>This query identifies functions with a nesting level higher than 3</p>CPGQL Query:<div class="code"><pre><code class="language-js">({cpg.method.internal.filter(_.depth(_.isControlStructure) &gt; n)}).l</code></pre></div><textarea class="hidden" id="too-nested">({cpg.method.internal.filter(_.depth(_.isControlStructure) &gt; n)}).l</textarea></div><div><span class="search-result-author">author: @fabsx00</span></div><div><span class="search-result-tags">tags: metrics</span></div><div><button class="MuiButtonBase-root MuiButton-root MuiButton-contained search-result-copy MuiButton-containedPrimary" tabindex="0" type="button"><span class="MuiButton-label">COPY TO CLIPBOARD</span></button></div></div></div><div class="MuiPaper-root MuiCard-root main-card mdc-elevation--z10 MuiPaper-elevation1 MuiPaper-rounded"><div class="search-result"><div><h2><span class="search-result-name">unchecked-read-recv-malloc</span></h2></div><div><h4>Unchecked read/recv/malloc</h4><p>
The return value of a read/recv/malloc call is not checked directly and
the variable it has been assigned to (if any) does not
occur in any check within the caller.
</p>CPGQL Query:<div class="code"><pre><code class="language-js">({implicit val noResolve: NoResolve.type = NoResolve
val callsNotDirectlyChecked = cpg
  .method(&quot;(?i)(read|recv|malloc)&quot;)
  .callIn
  .filterNot { y =&gt;
    val code = y.code
    y.inAstMinusLeaf.isControlStructure.condition.code.exists { x =&gt;
      x.contains(code)
    }
  }
  .l

callsNotDirectlyChecked.filterNot { call =&gt;
  val inConditions = call.method.controlStructure.condition.ast.l;
  val checkedVars = inConditions.isIdentifier.name.toSet ++ inConditions.isCall.code.toSet;
  val targets = call.inAssignment.target.code.toSet
  (targets &amp; checkedVars).nonEmpty
}}).l</code></pre></div><textarea class="hidden" id="unchecked-read-recv-malloc">({implicit val noResolve: NoResolve.type = NoResolve
val callsNotDirectlyChecked = cpg
  .method(&quot;(?i)(read|recv|malloc)&quot;)
  .callIn
  .filterNot { y =&gt;
    val code = y.code
    y.inAstMinusLeaf.isControlStructure.condition.code.exists { x =&gt;
      x.contains(code)
    }
  }
  .l

callsNotDirectlyChecked.filterNot { call =&gt;
  val inConditions = call.method.controlStructure.condition.ast.l;
  val checkedVars = inConditions.isIdentifier.name.toSet ++ inConditions.isCall.code.toSet;
  val targets = call.inAssignment.target.code.toSet
  (targets &amp; checkedVars).nonEmpty
}}).l</textarea></div><div><span class="search-result-author">author: @fabsx00</span></div><div><span class="search-result-tags">tags: default</span></div><div><button class="MuiButtonBase-root MuiButton-root MuiButton-contained search-result-copy MuiButton-containedPrimary" tabindex="0" type="button"><span class="MuiButton-label">COPY TO CLIPBOARD</span></button></div></div></div><div class="MuiPaper-root MuiCard-root main-card mdc-elevation--z10 MuiPaper-elevation1 MuiPaper-rounded"><div class="search-result"><div><h2><span class="search-result-name">xss-servlet</span></h2></div><div><h4>Reflected Cross-Site Scripting: Servlet Returns HTTP Input in Response</h4><p>
A servlet returns a URL parameter as part of the response.

Unless the parameter is escaped or validated in-between, this is a reflected XSS vulnerability.
</p>CPGQL Query:<div class="code"><pre><code class="language-js">({def source =
  cpg.call.methodFullNameExact(
    &quot;javax.servlet.http.HttpServletRequest.getParameter:java.lang.String(java.lang.String)&quot;
  )

def responseWriter =
  cpg.call.methodFullNameExact(
    &quot;javax.servlet.http.HttpServletResponse.getWriter:java.io.PrintWriter()&quot;
  )

def sinks =
  cpg.call
    .methodFullNameExact(
      &quot;java.io.PrintWriter.println:void(java.lang.String)&quot;
    )
    .where(_.argument(0).reachableBy(responseWriter))

sinks.where(_.argument(1).reachableBy(source))}).l</code></pre></div><textarea class="hidden" id="xss-servlet">({def source =
  cpg.call.methodFullNameExact(
    &quot;javax.servlet.http.HttpServletRequest.getParameter:java.lang.String(java.lang.String)&quot;
  )

def responseWriter =
  cpg.call.methodFullNameExact(
    &quot;javax.servlet.http.HttpServletResponse.getWriter:java.io.PrintWriter()&quot;
  )

def sinks =
  cpg.call
    .methodFullNameExact(
      &quot;java.io.PrintWriter.println:void(java.lang.String)&quot;
    )
    .where(_.argument(0).reachableBy(responseWriter))

sinks.where(_.argument(1).reachableBy(source))}).l</textarea></div><div><span class="search-result-author">author: @maltek</span></div><div><span class="search-result-tags">tags: xss,default</span></div><div><button class="MuiButtonBase-root MuiButton-root MuiButton-contained search-result-copy MuiButton-containedPrimary" tabindex="0" type="button"><span class="MuiButton-label">COPY TO CLIPBOARD</span></button></div></div></div></div></div></div></div></div></section></main></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2021 The Joern Team.</div></div></div></footer></div>
<script src="/styles.7288b055.js"></script>
<script src="/runtime~main.122311ab.js"></script>
<script src="/main.4970da00.js"></script>
<script src="/common.e559ae0f.js"></script>
<script src="/8.f7bcd556.js"></script>
<script src="/c4f5d8e4.526791da.js"></script>
</body>
</html>